<!doctype html><html lang=zh>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=generator content="Wowchemy 5.3.0 for Hugo">
<link rel=preconnect href=https://fonts.gstatic.com crossorigin>
<link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
<link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload="this.media='all'">
<meta name=author content="曦曦呵呵">
<meta name=description content="月老狂喜……">
<link rel=alternate hreflang=zh href=/notes/oiknowledge/graph%E5%9B%BE%E8%AE%BA/%E4%BA%8C%E5%88%86%E5%9B%BE%E5%8C%B9%E9%85%8D/>
<meta name=theme-color content="#8a2be2">
<script src=/js/mathjax-config.js></script>
<link rel=stylesheet href=/css/vendor-bundle.min.f1ecf783c14edc00c9320c205831ad8e.css media=print onload="this.media='all'">
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css crossorigin=anonymous title=hl-light media=print onload="this.media='all'">
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css crossorigin=anonymous title=hl-dark media=print onload="this.media='all'" disabled>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin=anonymous media=print onload="this.media='all'">
<script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js integrity crossorigin=anonymous async></script>
<link rel=stylesheet href=/css/wowchemy.36d7c79ef70cfd4ede320d3031e72a79.css>
<link rel=manifest href=/manifest.webmanifest>
<link rel=icon type=image/png href=/media/icon_huf638f59a6dd2257b0add8e0186347459_300061_32x32_fill_lanczos_center_3.png>
<link rel=apple-touch-icon type=image/png href=/media/icon_huf638f59a6dd2257b0add8e0186347459_300061_180x180_fill_lanczos_center_3.png>
<link rel=canonical href=/notes/oiknowledge/graph%E5%9B%BE%E8%AE%BA/%E4%BA%8C%E5%88%86%E5%9B%BE%E5%8C%B9%E9%85%8D/>
<meta property="twitter:card" content="summary">
<meta property="og:site_name" content="Senie">
<meta property="og:url" content="/notes/oiknowledge/graph%E5%9B%BE%E8%AE%BA/%E4%BA%8C%E5%88%86%E5%9B%BE%E5%8C%B9%E9%85%8D/">
<meta property="og:title" content="二分图匹配 | Senie">
<meta property="og:description" content="月老狂喜……"><meta property="og:image" content="/media/icon_huf638f59a6dd2257b0add8e0186347459_300061_512x512_fill_lanczos_center_3.png">
<meta property="twitter:image" content="/media/icon_huf638f59a6dd2257b0add8e0186347459_300061_512x512_fill_lanczos_center_3.png"><meta property="og:locale" content="zh">
<meta property="article:published_time" content="2021-10-18T00:00:00+00:00">
<meta property="article:modified_time" content="2021-10-18T00:00:00+00:00">
<title>二分图匹配 | Senie</title>
</head>
<body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=5f206a9dac4ab2661a08d3631ecd2de1>
<script src=/js/wowchemy-init.min.2da3b1fa37e894630bf6de39b1b694b3.js></script>
<aside class=search-modal id=search>
<div class=container>
<section class=search-header>
<div class="row no-gutters justify-content-between mb-3">
<div class=col-6>
<h1>搜索</h1>
</div>
<div class="col-6 col-search-close">
<a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a>
</div>
</div>
<div id=search-box>
<input name=q id=search-query placeholder=搜索... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=搜索...>
</div>
</section>
<section class=section-search-results>
<div id=search-hits>
</div>
</section>
</div>
</aside>
<div class=page-header>
<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main>
<div class=container-xl>
<div class="d-none d-lg-inline-flex">
<a class=navbar-brand href=/>Senie</a>
</div>
<button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label=切换导航>
<span><i class="fas fa-bars"></i></span>
</button>
<div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
<a class=navbar-brand href=/>Senie</a>
</div>
<div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content>
<ul class="navbar-nav d-md-inline-flex">
<li class=nav-item>
<a class="nav-link active" href=/notes/><span>OI</span></a>
</li>
<li class=nav-item>
<a class=nav-link href=/courses/><span>高中</span></a>
</li>
<li class="nav-item dropdown">
<a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>杂七杂八</span><span class=caret></span>
</a>
<div class=dropdown-menu>
<a class=dropdown-item href=/category/%e4%b9%90%e4%b9%90%e5%91%b5%e5%91%b5/><span>乐乐呵呵</span></a>
<a class=dropdown-item href=/category/%e6%8a%80%e6%9c%afblog/><span>技术blog</span></a>
</div>
</li>
</ul>
</div>
<ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
<li class="nav-item d-none d-lg-inline-flex">
<a class=nav-link href=https://github.com/Xu-Xihe data-toggle=tooltip data-placement=bottom title=在Github上关注我吧！ target=_blank rel=noopener aria-label=在Github上关注我吧！>
<i class="fab fa-github" aria-hidden=true></i>
</a>
</li>
<li class=nav-item>
<a class="nav-link js-search" href=# aria-label=搜索><i class="fas fa-search" aria-hidden=true></i></a>
</li>
<li class="nav-item dropdown theme-dropdown">
<a href=# class=nav-link data-toggle=dropdown aria-haspopup=true aria-label="Display preferences">
<i class="fas fa-moon" aria-hidden=true></i>
</a>
<div class=dropdown-menu>
<a href=# class="dropdown-item js-set-theme-light">
<span>浅色</span>
</a>
<a href=# class="dropdown-item js-set-theme-dark">
<span>深色</span>
</a>
<a href=# class="dropdown-item js-set-theme-auto">
<span>自动</span>
</a>
</div>
</li>
</ul>
</div>
</nav>
</div>
<div class=page-body>
<div class="container-fluid docs">
<div class="row flex-xl-nowrap">
<div class="col-12 col-md-3 col-xl-2 docs-sidebar">
<form class="docs-search d-flex align-items-center">
<button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation">
<div class=d-flex>
<span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">
图论
</span>
<span><i class="fas fa-chevron-down"></i></span>
</div>
</button>
<button class="form-control sidebar-search js-search d-none d-md-flex">
<i class="fas fa-search pr-2"></i>
<span class=sidebar-search-text>搜索...</span>
<span class=sidebar-search-shortcut>/</span>
</button>
</form>
<nav class="collapse docs-links" id=docs-nav>
<ul class="nav docs-sidenav">
<li><a href=/notes/><i class="fas fa-arrow-left pr-1"></i>OI</a></li>
</ul>
<div class=docs-toc-item>
<a class=docs-toc-link href=/notes/oiknowledge/>OI知识</a>
<ul class="nav docs-sidenav">
<div class=docs-toc-item>
<a class=docs-toc-link href=/notes/oiknowledge/basic%E5%9F%BA%E6%9C%AC%E6%80%9D%E6%83%B3/>基本思想</a>
<ul class="nav docs-sidenav">
<li><a href=/notes/oiknowledge/basic%E5%9F%BA%E6%9C%AC%E6%80%9D%E6%83%B3/%E9%80%92%E5%BD%92/>递推和递归</a></li>
<li><a href=/notes/oiknowledge/basic%E5%9F%BA%E6%9C%AC%E6%80%9D%E6%83%B3/%E5%88%86%E6%B2%BB/>分治（二分）</a></li>
<li><a href=/notes/oiknowledge/basic%E5%9F%BA%E6%9C%AC%E6%80%9D%E6%83%B3/%E8%B4%AA%E5%BF%83/>贪心</a></li>
<li><a href=/notes/oiknowledge/basic%E5%9F%BA%E6%9C%AC%E6%80%9D%E6%83%B3/%E5%80%8D%E5%A2%9E/>倍增</a></li>
<li><a href=/notes/oiknowledge/basic%E5%9F%BA%E6%9C%AC%E6%80%9D%E6%83%B3/%E4%B8%89%E5%88%86/>三分</a></li>
<li><a href=/notes/oiknowledge/basic%E5%9F%BA%E6%9C%AC%E6%80%9D%E6%83%B3/test/>test</a></li>
</ul>
</div>
<div class=docs-toc-item>
<a class=docs-toc-link href=/notes/oiknowledge/graph%E5%9B%BE%E8%AE%BA/>图论</a>
<ul class="nav docs-sidenav">
<li><a href=/notes/oiknowledge/graph%E5%9B%BE%E8%AE%BA/%E6%90%9C%E7%B4%A2/>搜索</a></li>
<li><a href=/notes/oiknowledge/graph%E5%9B%BE%E8%AE%BA/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/>拓扑排序</a></li>
<li><a href=/notes/oiknowledge/graph%E5%9B%BE%E8%AE%BA/%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/>最小生成树</a></li>
<li><a href=/notes/oiknowledge/graph%E5%9B%BE%E8%AE%BA/%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/>最短路径</a></li>
<li><a href=/notes/oiknowledge/graph%E5%9B%BE%E8%AE%BA/spfa-dfs%E8%B4%9F%E7%8E%AF%E8%AF%81%E6%98%8E/>SPFA-DFS负环证明</a></li>
<li><a href=/notes/oiknowledge/graph%E5%9B%BE%E8%AE%BA/%E5%BC%BA%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F%E4%B8%8E%E7%BC%A9%E7%82%B9/>强连通分量与缩点</a></li>
<li><a href=/notes/oiknowledge/graph%E5%9B%BE%E8%AE%BA/%E6%A0%91%E9%93%BE%E5%89%96%E5%88%86/>树链刨分</a></li>
<li><a href=/notes/oiknowledge/graph%E5%9B%BE%E8%AE%BA/%E6%AC%A7%E6%8B%89%E5%9B%9E%E8%B7%AF/>欧拉回路</a></li>
<li class=active><a href=/notes/oiknowledge/graph%E5%9B%BE%E8%AE%BA/%E4%BA%8C%E5%88%86%E5%9B%BE%E5%8C%B9%E9%85%8D/>二分图匹配</a></li>
<li><a href=/notes/oiknowledge/graph%E5%9B%BE%E8%AE%BA/%E5%B7%AE%E5%88%86%E7%BA%A6%E6%9D%9F/>差分约束</a></li>
<li><a href=/notes/oiknowledge/graph%E5%9B%BE%E8%AE%BA/01%E5%88%86%E6%95%B0%E8%A7%84%E5%88%92/>01分数规划</a></li>
<li><a href=/notes/oiknowledge/graph%E5%9B%BE%E8%AE%BA/%E5%9D%90%E6%A0%87%E8%A1%A8%E7%A4%BA%E6%B3%95/>坐标距离</a></li>
</ul>
</div>
<div class=docs-toc-item>
<a class=docs-toc-link href=/notes/oiknowledge/dp%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/>动态规划</a>
<ul class="nav docs-sidenav">
<li><a href=/notes/oiknowledge/dp%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/>背包问题</a></li>
<li><a href=/notes/oiknowledge/dp%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E7%BA%BF%E6%80%A7dp/>线性dp</a></li>
<li><a href=/notes/oiknowledge/dp%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/kmp/>KMP</a></li>
<li><a href=/notes/oiknowledge/dp%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E5%8C%BA%E9%97%B4dp/>区间dp</a></li>
<li><a href=/notes/oiknowledge/dp%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E6%A0%91%E5%BD%A2dp/>树形dp</a></li>
<li><a href=/notes/oiknowledge/dp%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E7%8A%B6%E6%80%81%E5%8E%8B%E7%BC%A9dp/>状压dp</a></li>
<li><a href=/notes/oiknowledge/dp%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/manacher%E7%AE%97%E6%B3%95/></a></li>
</ul>
</div>
<div class=docs-toc-item>
<a class=docs-toc-link href=/notes/oiknowledge/data%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/>数据结构</a>
<ul class="nav docs-sidenav">
<li><a href=/notes/oiknowledge/data%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%B9%B6%E6%9F%A5%E9%9B%86/>并查集</a></li>
<li><a href=/notes/oiknowledge/data%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%88/>栈</a></li>
<li><a href=/notes/oiknowledge/data%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E9%98%9F%E5%88%97/>队列</a></li>
<li><a href=/notes/oiknowledge/data%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%88%86%E5%9D%97/>分块</a></li>
<li><a href=/notes/oiknowledge/data%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%A0%86/>堆</a></li>
<li><a href=/notes/oiknowledge/data%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%B7%A6%E5%81%8F%E6%A0%91/>左偏树（可并堆）</a></li>
<li><a href=/notes/oiknowledge/data%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%B9%B3%E8%A1%A1%E6%A0%91/>平衡树</a></li>
<li><a href=/notes/oiknowledge/data%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/>树状数组</a></li>
<li><a href=/notes/oiknowledge/data%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BA%BF%E6%AE%B5%E6%A0%91/>线段树</a></li>
<li><a href=/notes/oiknowledge/data%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/st%E8%A1%A8/>ST表</a></li>
<li><a href=/notes/oiknowledge/data%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%AD%97%E5%85%B8%E6%A0%91/>字典树</a></li>
<li><a href=/notes/oiknowledge/data%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/hash%E8%A1%A8/>Hash表</a></li>
</ul>
</div>
<div class=docs-toc-item>
<a class=docs-toc-link href=/notes/oiknowledge/math%E6%95%B0%E8%AE%BA/>数论</a>
<ul class="nav docs-sidenav">
<li><a href=/notes/oiknowledge/math%E6%95%B0%E8%AE%BA/%E5%BF%AB%E9%80%9F%E5%B9%82/>快速幂</a></li>
<li><a href=/notes/oiknowledge/math%E6%95%B0%E8%AE%BA/%E8%B4%A8%E6%95%B0%E5%90%88%E6%95%B0%E7%BA%A6%E6%95%B0%E5%80%8D%E6%95%B0/>质数、合数、约数</a></li>
<li><a href=/notes/oiknowledge/math%E6%95%B0%E8%AE%BA/%E6%95%B0%E5%AD%A6%E8%A1%A8%E7%A4%BA/>数学表示</a></li>
<li><a href=/notes/oiknowledge/math%E6%95%B0%E8%AE%BA/%E5%90%8C%E4%BD%99%E6%96%B9%E7%A8%8B/></a></li>
<li><a href=/notes/oiknowledge/math%E6%95%B0%E8%AE%BA/%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0/></a></li>
<li><a href=/notes/oiknowledge/math%E6%95%B0%E8%AE%BA/%E7%9F%A9%E9%98%B5%E4%B9%98%E6%B3%95/></a></li>
<li><a href=/notes/oiknowledge/math%E6%95%B0%E8%AE%BA/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/></a></li>
<li><a href=/notes/oiknowledge/math%E6%95%B0%E8%AE%BA/%E9%AB%98%E6%96%AF%E6%B6%88%E5%85%83/></a></li>
</ul>
</div>
<div class=docs-toc-item>
<a class=docs-toc-link href=/notes/oiknowledge/others%E6%9D%82%E9%A1%B9/>杂项</a>
<ul class="nav docs-sidenav">
<li><a href=/notes/oiknowledge/others%E6%9D%82%E9%A1%B9/c++-stl/>C++ STL</a></li>
<li><a href=/notes/oiknowledge/others%E6%9D%82%E9%A1%B9/%E7%A6%BB%E6%95%A3%E5%8C%96/>离散化</a></li>
<li><a href=/notes/oiknowledge/others%E6%9D%82%E9%A1%B9/%E5%B7%AE%E5%88%86%E6%95%B0%E7%BB%84/>差分数组</a></li>
<li><a href=/notes/oiknowledge/others%E6%9D%82%E9%A1%B9/%E4%BD%8D%E8%BF%90%E7%AE%97/>位运算</a></li>
</ul>
</div>
</ul>
</div>
</nav>
</div>
<div class="d-none d-xl-block col-xl-2 docs-toc">
<ul class="nav toc-top">
<li><a href=# id=back_to_top class=docs-toc-title>在本页</a></li>
</ul>
<nav id=TableOfContents>
<ul>
<li><a href=#前置知识二分图>前置知识——二分图</a></li>
<li><a href=#最大匹配>最大匹配</a></li>
<li><a href=#匈牙利算法寻找最大匹配>匈牙利算法——寻找最大匹配</a>
<ul>
<li><a href=#交替路与增广路>交替路与增广路</a></li>
<li><a href=#匈牙利算法的真面目>匈牙利算法的真面目</a></li>
</ul>
</li>
<li><a href=#最大匹配的引申>最大匹配的引申</a>
<ul>
<li><a href=#最小边覆盖-n---最大匹配>最小边覆盖= n - 最大匹配</a></li>
<li><a href=#最小点覆盖--最大匹配>最小点覆盖 = 最大匹配</a></li>
<li><a href=#最大独立集--n---最小点覆盖>最大独立集 = n - 最小点覆盖</a></li>
<li><a href=#最小不可重链覆盖>最小不可重链覆盖</a></li>
<li><a href=#有权最大匹配等>有权最大匹配等</a></li>
</ul>
</li>
</ul>
</nav>
</div>
<main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role=main>
<article class=article>
<div class=docs-article-container>
<nav class="d-none d-md-flex" aria-label=breadcrumb>
<ol class=breadcrumb>
<li class=breadcrumb-item>
<a href=/>
Home
</a>
</li>
<li class=breadcrumb-item>
<a href=/notes/>
OI
</a>
</li>
<li class=breadcrumb-item>
<a href=/notes/oiknowledge/>
OI知识
</a>
</li>
<li class=breadcrumb-item>
<a href=/notes/oiknowledge/graph%E5%9B%BE%E8%AE%BA/>
图论
</a>
</li>
<li class="breadcrumb-item active" aria-current=page>
二分图匹配
</li>
</ol>
</nav>
<h1>二分图匹配</h1>
<div class=article-style>
<h1 id=二分图匹配>二分图匹配</h1>
<h2 id=前置知识二分图>前置知识——二分图</h2>
<p>首先，要明白什么是二分图(又称作二部图)。</p>
<p>形象的描述一下，现在你是某市的市长，而一条大河从你的城市中心穿流而过。所以，你为了使你的城市交通遍历，促进城市发展，你决定在这条河上建桥，以连接河两岸的路口。</p>
<img src=%E8%8D%89%E7%BA%B8-10.jpg alt=pi style=zoom:33%>
<p>如上图，所有河上的桥和路口就组成了一个二分图。</p>
<p>二分图的定义：如果顶点 $V $ 可分割为两个互不相交的子集 $(A,B)$，并且图中的每条边 $(i，j)$ 所关联的两个顶点 $i$ 和 $j$ 分别属于这两个不同的顶点集 $(i \in A,j \in B)$，则称图G为一个二分图。简而言之，就是顶点集 $V$ 可分割为两个互不相交的子集，并且图中每条边依附的两个顶点都分属于这两个互不相交的子集，两个子集内的顶点不相邻。</p>
<p>意思就说，你把一个图的顶点分到河的两岸，图上所有的边只能是桥，不能是陆地上的公路，即不能在河的一侧修建边。</p>
<img src=graph.png alt=sdafa style=zoom:67%>
<p>区别二分图，关键是看点集是否能分成两个独立的点集。无向图G为二分图的<strong>充要条件</strong>是，$G$ 至少有两个顶点，且其所有环的长度均为偶数，<strong>不存在奇环</strong>。<strong>可以存在偶环</strong>，如上图 $2\rightarrow7\rightarrow3\rightarrow8\rightarrow2$ 就是一个偶环，但上图满足二分图。任何无回路的的图均是二分图。</p>
<p>**总结：**DFS/BFS，如发现奇环则不是二分图，否则是。</p>
<p><a href=https://baike.baidu.com/item/%E4%BA%8C%E5%88%86%E5%9B%BE target=_blank rel=noopener>充要条件的证明(百度百科)</a></p>
<p>更简单的：因为每一条边都是从一个集合走到另一个集合，只有走偶数次才可能回到同一个集合。</p>
<h2 id=最大匹配>最大匹配</h2>
<p>**匹配：**从二分图中选择 $n$ 条边，保证没有任何一个顶点是两条或以上边的终点。</p>
<p>一个形象的事情：</p>
<p>现在你变身成为了月老，发现今天有 $n$ 个男生和 $m$ 个女生在你的庙(月老庙)前许愿求姻缘。你今天很高兴，决定帮帮他们。他们每个人祈祷的时候都说了他们心仪的对象，你将他们整理了一下，将可能(符合双方的要求 -__- )的两个人之间连一条线(假设没有gay)，建立了一个二分图。</p>
<p>这时候，作为善良的你，需要履行帮助人类繁衍生息的职责，因此要促成尽可能多的情侣狗，问最多能搞成几对？</p>
<p>数学表示：若 $E'\in E$，且 $E'$ 中任意两条边不共用同一个顶点，则称 $E'$ 是二分图 $G$ 的一个匹配。</p>
<p>**最大匹配：**边数最多的匹配(促成的情侣狗最多)。即 $E'$ 中边数最大。</p>
<p>**完美匹配：**所有向你求愿单身狗都变成了情侣狗。即 $E'=E$。</p>
<h2 id=匈牙利算法寻找最大匹配>匈牙利算法——寻找最大匹配</h2>
<h3 id=交替路与增广路>交替路与增广路</h3>
<p>**交替路：**从一个未匹配点出发，依次经过非匹配边、匹配边，并且第一条和最后一条边均为非匹配边，形成的路径叫交替路。</p>
<p>**增广路：**从一个未匹配点出发，走交替路，如果途径另一个未匹配点（出发的点不算），则这条交替路称为增广路。</p>
<ol>
<li>
<p>红色的边为当前的匹配
<img src=%E5%A2%9E%E5%B9%BF%E8%B7%AF1.png alt=1 style=zoom:13%></p>
</li>
<li>
<p>紫色的边为当前匹配的增广路
<img src=%E5%A2%9E%E5%B9%BF%E8%B7%AF2.png alt=2 style=zoom:13%></p>
</li>
<li>
<p>将增广路中匹配的边和非匹配变交换，匹配边数 $+1$
<img src=%E5%A2%9E%E5%B9%BF%E8%B7%AF3.png alt=3 style=zoom:13%></p>
</li>
</ol>
<h3 id=匈牙利算法的真面目>匈牙利算法的真面目</h3>
<p>匈牙利算法是由匈牙利数学家Edmonds于1965年提出，因而得名。匈牙利算法是基于Hall定理中充分性证明的思想，它是部图匹配最常见的算法，该算法的核心就是寻找增广路径，它是一种用增广路径求二分图最大匹配的算法。<del>(看完的都是好宝宝)</del></p>
<p><a href="https://blog.csdn.net/qq_41730082/article/details/81162561?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522162919822716780274126376%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=162919822716780274126376&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-81162561.pc_search_result_control_group&utm_term=%E4%BA%8C%E5%88%86%E5%9B%BE%E5%8C%B9%E9%85%8D&spm=1018.2226.3001.4187" target=_blank rel=noopener>有意思的博文一篇</a></p>
<p>简单一点，就是一个不断逼近答案的过程。</p>
<p>对于每个节点，执行如下步骤：</p>
<ol>
<li>如果连接这个节点的任何一条边可以被选中，则将这条边加入匹配，返回TRUE。</li>
<li>如果莫得可以加入的边了，那么可以推导出连接它的所有边均为非匹配边。然后开始逐个寻找增广路，直到全部遍历完成(返回FALSE)或者把其中的某一条边加入匹配(即找到了一条增广路，返回TRUE)。</li>
</ol>
<p><del>这个东西的烦人之处在于这玩意的代码………………难以理解，需得手推</del></p>
<p><a href=https://www.luogu.com.cn/problem/P3386 target=_blank rel=noopener>洛谷P3386</a></p>
<pre><code class=language-c++>#include &lt;cstdio&gt;
#include &lt;bitset&gt;
#include &lt;vector&gt;
const int maxe = 600;
int n, m, e, ans, pot[maxe]; //一共有n个男生,m个女生,共e条边,pot[i]表示第i个女生属于的男生编号
std::bitset&lt;maxe&gt; vis;       //标记是否访问过(名花有主)
std::vector&lt;int&gt; con[maxe];  //以男生的角度记录这张图(因为要遍历男生找女生)
inline bool dfs(int now)
{
    for (auto i : con[now]) //遍历他有好感的所有女生
    {
        if (!vis[i]) //如果这个女生现在莫得npy
        {
            vis[i] = 1;                 //表示你就是我的了
            if (!pot[i] || dfs(pot[i])) //如果你原先没有npy或者前男友鱼塘里还有
            {
                pot[i] = now; //你现在彻底是我的了
                return true;  //表示我找到npy了(-_-)
            }
        }
    }
    return false; //我没有找到(T_T)
}
int main()
{
    scanf(&quot;%d%d%d&quot;, &amp;n, &amp;m, &amp;e);
    for (int i = 0; i &lt; e; i++)
    {
        int a, b;
        scanf(&quot;%d%d&quot;, &amp;a, &amp;b);
        con[a].push_back(b);
    }
    for (int i = 1; i &lt;= n; i++)
    {
        vis.reset(); //每次都重新分配
        if (dfs(i))  //如果现在的这个男生找到了npy,就又多了一对情侣
            ans++;
    }
    printf(&quot;%d&quot;, ans);
    return 0;
}
</code></pre>
<p>时间复杂度 $O(nm)$ 。</p>
<h2 id=最大匹配的引申>最大匹配的引申</h2>
<h3 id=最小边覆盖-n---最大匹配>最小边覆盖= n - 最大匹配</h3>
<p>一个边集里的边能覆盖所有的点，最小边覆盖是满足这个要求的所有边集中边数最少的一个。</p>
<p><strong>证明：</strong></p>
<p>因为边数越小越好，则每条边能覆盖的点一定是越多越好(尽量每条边都覆盖2个点)，而最大匹配找出了最多覆盖2个点的边。而剩下的就只能一条边覆盖一个点了。</p>
<p>所以，设总顶点数为 $n$，最大匹配边为 $m$，则可以得到
$$
最小边覆盖=m+(n-2m)=n-m
$$</p>
<h3 id=最小点覆盖--最大匹配>最小点覆盖 = 最大匹配</h3>
<p>**最小点覆盖：**假如选了一个点就相当于覆盖了以它为端点的所有边。最小点覆盖就是选择最少的点来覆盖所有的边。</p>
<p>**证明：**由最大匹配可知，不存在一条边的两个端点均没有被在最大匹配集合中的边所连接的情况(否则这条边就可以加入匹配)。因此，我们可以将边分为两类：匹配边和非匹配边；也可以将点分为两类：是匹配边的端点和不是匹配边的端点。</p>
<img src=%E6%9C%80%E5%B0%8F%E7%82%B9%E8%A6%86%E7%9B%96.png alt=df style=zoom:13%>
<p>如上图，<font color=red>匹配边</font>，非匹配边，<font color=purple>匹配边的端点</font>，<font color=green>不是匹配边的端点</font>。</p>
<p>在<font color=purple>匹配边的端点</font>中选择有相邻<font color=green>不是匹配边的端点</font>的点即可。</p>
<p>这样的点保证之多有最大匹配个。</p>
<p>首先，我们只要没傻到在同一条<font color=red>匹配边</font>上选择两个点就行，这样，所有的<font color=red>匹配边</font>均可被覆盖。</p>
<p>同一条<font color=red>匹配边</font>上的端点不可能同时与<font color=green>不是匹配边的端点</font>相邻，否则构成一条增广路(如上图，若有11号节点与9号节点连接，则 $11\rightarrow9\rightarrow5\rightarrow10$ 构成增广路)。</p>
<p>因此，最小点覆盖 = 最大匹配。</p>
<h3 id=最大独立集--n---最小点覆盖>最大独立集 = n - 最小点覆盖</h3>
<p>选出一些顶点使得这些顶点两两不相邻，则这些点构成的集合称为独立集。找出一个包含顶点数最多的独立集称为最大独立集。</p>
<p>**证明：**去掉最小点覆盖的顶点后，所有点之间不连通(因为删去最小点覆盖保证所有边均删除，因此不会出现连通)。</p>
<h3 id=最小不可重链覆盖>最小不可重链覆盖</h3>
<h3 id=有权最大匹配等>有权最大匹配等</h3>
<p>参见<a href>网络流</a>和<a href>费用流</a>。</p>
</div>
<div class=article-widget>
<div class=post-nav>
<div class=post-nav-item>
<div class=meta-nav>上一页</div>
<a href=/notes/oiknowledge/graph%E5%9B%BE%E8%AE%BA/%E6%AC%A7%E6%8B%89%E5%9B%9E%E8%B7%AF/ rel=next>欧拉回路</a>
</div>
<div class=post-nav-item>
<div class=meta-nav>下一页</div>
<a href=/notes/oiknowledge/graph%E5%9B%BE%E8%AE%BA/%E5%B7%AE%E5%88%86%E7%BA%A6%E6%9D%9F/ rel=prev>差分约束</a>
</div>
</div>
</div>
</div>
<div class=body-footer>
<p>最近更新于 2021年10月18日</p>
</div>
</article>
<footer class=site-footer>
<p class=powered-by>
© 曦曦呵呵
</p>
<p class=powered-by>
由<a href="https://wowchemy.com/?utm_campaign=poweredby" target=_blank rel=noopener>Wowchemy</a>支持发布——免费<a href=https://github.com/wowchemy/wowchemy-hugo-themes target=_blank rel=noopener>开源</a>网站，为创作者赋能。
</p>
</footer>
</main>
</div>
</div>
</div>
<div class=page-footer>
</div>
<div id=modal class="modal fade" role=dialog>
<div class=modal-dialog>
<div class=modal-content>
<div class=modal-header>
<h5 class=modal-title>引用</h5>
<button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span>
</button>
</div>
<div class=modal-body>
<pre><code class="tex hljs"></code></pre>
</div>
<div class=modal-footer>
<a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank>
<i class="fas fa-copy"></i> 复制
</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank>
<i class="fas fa-download"></i> 下载
</a>
<div id=modal-error></div>
</div>
</div>
</div>
</div>
<script src=/js/vendor-bundle.min.b73dfaac3b6499dc997741748a7c3fe2.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.8.4/mermaid.min.js integrity="sha512-as1BF4+iHZ3BVO6LLDQ7zrbvTXM+c/1iZ1qII/c3c4L8Rn5tHLpFUtpaEtBNS92f+xGsCzsD7b62XP3XYap6oA==" crossorigin=anonymous title=mermaid></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/python.min.js crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/latex.min.js crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.2/anchor.min.js integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin=anonymous></script>
<script>anchors.add()</script>
<script id=search-hit-fuse-template type=text/x-template>
        <div class="search-hit" id="summary-{{key}}">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{title}}</a>
              <div class="article-metadata search-hit-type">{{type}}</div>
              <p class="search-hit-description">{{snippet}}</p>
            </div>
          </div>
        </div>
      </script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin=anonymous></script>
<script src=/zh/js/wowchemy.min.d16321ec6884b061cbaaf961484b65c8.js></script>
</body>
</html>